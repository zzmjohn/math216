\section{Motivating example: the sheaf of differentiable functions}

\begin{exercise}
  As every element of~$\mathcal{O}_p\setminus\mathfrak{m}$ is nonzero in a neighbourhood of~$p$ we can restrict an element such that it is invertible there, a property which is preserved when taking the stalk. Hence the germ of a non-vanishing function is invertible and~$\mathfrak{m}$ is invertible.
\end{exercise}

\begin{exercise} % TODO find out what is asked for
  I don't really have a differential geometry background and I fail to see what should be proved. But I should revisit this exercise later.
\end{exercise}


\section{Definition of sheaf and presheaf}

\begin{exercise}
  A functor assigns an object in~$\category{Sets}$ to every object in the category of open sets of the topological space~$X$. As an inclusion of sets is reflected as a morphism of the two open sets involved, this is translated to a morphism of sets in the codomain category\footnote{I have never seen this terminology, don't shoot me if I missed some more obvious wording.}. Identities are preserved by functors, so~$\res_{U,U}=\identity_{\mathcal{F}(U)}$ by definition. For the commutativity of restriction maps, this is by the \emph{contravariance} of the functor.
\end{exercise}

\begin{exercise}
  \begin{enumerate}
    \item The presheaf axioms are (trivially) true by restriction of functions. Yet it is not a sheaf, take~$x\mapsto|x|$. On~$\ball(0,n)$ the function is bounded by~$n$, we can take~$\mathbb{C}=\bigcup_{n\in\mathbb{N}}\ball(0,n)$ and glue together a function on all of~$\mathbb{C}$ yet it is not bounded hence not a section over~$\mathcal{C}$ of this sheaf.

    \item Inspired by \href{http://math.stackexchange.com/questions/38423/presheaf-which-is-not-a-sheaf-holomorphic-functions-which-admit-a-holomorphic}{\texttt{math.stackexcange.com}} (and my complex analysis course) the idea is to circle a zero, ending up with a multiple-valued function, which is clearly not a section of the sheaf.

      Take~$f\colon z\mapsto z$ on the annulus~$U=\left\{ 1-\epsilon<|z|<1+\epsilon \right\}$. By the Cauchy integral formula we have
      \begin{equation}
        \oint_{\mathclap{|z|=1}}\frac{g'(z)}{g(z)}\dd z\in2\pi\mathrm{i}\mathbb{Z}
      \end{equation}
      where~$g$ is holomorphic, without zeroes on the unit circle. Hence for~$f$ we obtain~$2\pi\mathrm{i}$.

      But if~$f=g^2$ we would obtain
      \begin{equation}
        \oint_{\mathclap{|z|=1}}\frac{f'(z)}{f(z)}\dd z=2\oint_{\mathclap{|z|=1}}\frac{g'(z)}{g(z)}\dd z\in4\pi\mathrm{i}\mathbb{Z}
      \end{equation}
      which is a contradiction on the value we previously obtained. Now~$f$ can be patched together from holomorphic functions that admit a square root, as long as the open set doesn't wind around zero: take open balls to cover~$U$ and we're done.
  \end{enumerate}
\end{exercise}

\begin{exercise}
  As we have maps~$\mathcal{F}(\bigcup U_i)\to\mathcal{F}(U_i)$ (or arbitrary unions of~$U_i$) this is a limit: the arrows from our desired object map \emph{to} all the objects as described in~2.4.4.
\end{exercise}

\begin{exercise}
  \label{exercise:32d}
  \begin{enumerate}
    \item Such functions are defined in their points, if all the restrictions agree for a covering, the functions are obviously equal. The identity axiom is satisfied. But given a covering on which all restrictions agree we can just paste together a global function, hence the gluability axiom is satisfied~too.

      Glueing functions preserves their extra properties: these are all defined in a neighbourhood of a point, hence valid in an open set and therefore lift to the global function.

    \item Analogous.
  \end{enumerate}
\end{exercise}

\begin{exercise}
  The presheaf axioms are trivially satisfied, local functions restrict easily. The identity axiom is obvious too. For the gluability: observe that the compatibility boils down to defining a function on the \emph{connected components} of the covering because sections are constant if there is a non-empty intersection and therefore this axiom is satisfied too.
\end{exercise}

\begin{exercise}
  \label{exercise:32f}
 The key idea is ``a function is continuous'' if and only if ``locally a function is continuous''. Hence restriction of continuous functions is well defined and the commutativity of the restriction triangle is immediate. Now for the identity axiom: equality of functions is checked in the points and as all restrictions agree the global sections must agree. Likewise we can check the gluability axiom.
\end{exercise}

\begin{exercise}
  \begin{enumerate}
    \item The sections of~$f$ over~$U$ form a subset of the sections of the sheaf from~\autoref{exercise:32f} over~$U$. The restrictions are trivially fine, the identity axiom follows from the previous exercise too and gluability is obviously true as well as~$f\circ s=\identity|_U$ holds for the pointwise glueing of a section.

    \item There is nothing to add to the arguments of~\autoref{exercise:32d}. The set of sections carries a natural pointwise abelian group structure.
  \end{enumerate}
\end{exercise}

\begin{exercise}
  The presheaf axioms are satisfied because~$f$ is continuous hence the inverse~$f^{-1}$ maps open sets to open sets. The presheaf axioms are satisfied on the open sets in the domain of the map and the presheaf axioms for~$f_*\mathcal{F}$ are a subset (sketchy wording) of those for~$\mathcal{F}$.

  The sheaf axioms are satisfied because inverse maps are compatible with unions and intersections. As for the presheaf axioms: everything is transferred.
\end{exercise}

\begin{exercise}
  Using the definition of the direct limit and the construction as described in~\autoref{exercise:23c} we see that \emph{less} relations have to be quotiented, as the direct system defining~$(f_*\mathcal{F})_y$ is contained in the direct system defining~$\mathcal{F}_p$.
\end{exercise}

\begin{exercise}
  As germs in the stalk~$\mathcal{F}_x$ are equivalence classes of functions defined in the neighbourhood modulo equality on a (smaller) neighbourhood, we can define the~$\mathcal{O}_{X,x}$\nobreakdash-module structure on~$\mathcal{F}_x$ by defining it on representatives of these classes. By commutativity of~(3.2.12.1) this is well defined. The actual checking of the structure is straightforward and familiar.
\end{exercise}


\section{Morphisms of presheaves and sheaves}

\begin{exercise}
  The induced morphism is given by applying the morphism to representatives of equivalence classes of the stalks. By commutativity of the diagram in the definition of (pre)sheaf morphisms this is correct.
\end{exercise}

\begin{exercise}
  To every sheaf~$\mathcal{F}$ in~$\category{Sets}_X$ there is a (unique) associated sheaf~$f_*(\mathcal{F})$ in~$\category{Sets}_Y$. Obviously~$f_*(\identity_\mathcal{F})=\identity_{f_*(\mathcal{F})}$ and we have~$f_*(h\circ g)$ with~$g\colon\mathcal{F}\to\mathcal{G}$ and~$h\colon\mathcal{G}\to\mathcal{H}$ by applying this to every open set~$U$.
\end{exercise}

\begin{exercise}
  The presheaf axioms are easy: the associated restriction is just the obvious restriction of a function~$f\colon\mathcal{F}(U)\to\mathcal{G}(U)$ to~$f|_V\colon\mathcal{F}(V)\to\mathcal{G}(V)$ in~$\SheafHom(\mathcal{F},\mathcal{G})(V)$ for~$V\subseteq U$.

  The identity axiom for~$\SheafHom$ follows from the separatedness of~$\mathcal{G}$. Take a cover~$(U_i)_i$ of~$U$, any open subset~$V$ of~$U$ and a section~$s\in\mathcal{F}(V)$. Now we have~$f(V)(s)|_{U_i\cap V}=g(V)(s)|_{U_i\cap V}$ (which are elements of the sheaf~$\mathcal{G}$) for the covering~$(U_i\cap V)_i$ of~$V$. As~$\mathcal{G}$ is assumed to be separated we obtain~$f(V)(s)=g(V)(s)$. As this holds for any~$V$ and all sections~$s$, we have that~$\SheafHom$ is a separated presheaf.

  Now consider a family~$(f_i)_i$ of compatible sections (which are morphisms of sets of sections) on a cover~$(U_i)_i$ of~$U$. Like the case of the identity axiom, we consider~$V\subseteq U$ open and~$s\in\mathcal{F}(V)$. This gives
  \begin{equation}
    f_i(U_i\cap V)(s|_{U_i\cap V})\in\mathcal{G}(U_i\cap V).
  \end{equation}
  Now glue together~$f(V)(s)$ in~$\mathcal{G}(V)$. This defines a morphism of presheaves, by separatedness of~$\mathcal{G}$ (the compatibility of restrictions is induced in a unique way).

  If~$\mathcal{G}$ is a sheaf of abelian groups, morphisms~$\mathcal{F}\to\mathcal{G}$ carry a natural group structure, by pointwise addition. The neutral element is the zero map.
\end{exercise}

\begin{exercise}
  \begin{enumerate}
    \item By definition
      \begin{equation}
        \SheafHom\left( \underline{\left\{ p \right\}},\mathcal{F} \right)=\Mor\left( \underline{\left\{ p \right\}}|_U=\left\{ p \right\},\mathcal{F}|_U \right).
      \end{equation}
      As there is a unique map~$f_x\colon\left\{ p \right\}\to\mathcal{F}|_U:p\mapsto x$ for every element of~$x\in\mathcal{F}|_U$ (hence a bijection of sets) we have obtained an isomorphism of sheaves.

    \item\label{enumerate:exercise-33d-b} Analogously we now have a map~$f_g\colon\underline{\mathbb{Z}}(U)=\mathbb{Z}\to\mathcal{F}(U)$ such that~$1\mapsto g$, defined for every~$g\in\mathcal{F}(U)$. Now take sections~$g$ and~$g'\in\mathcal{F}(U)$. We obtain~$f_{g+g'}=f_g+f_{g'}$ because the image of~$1$ defines everything (\ie,~$\mathbb{Z}$ is the free group generated by~$\left\{ 1 \right\}$).

    \item Analogous to~\ref{enumerate:exercise-33d-b}.
  \end{enumerate}
\end{exercise}

\begin{exercise}
  In the situation of the diagram as given in the notes, we have injective maps~$\ker_{\textrm{pre}}\phi(V)\to\mathcal{F}(V)$ for every~$V$ open. Define~$\res^{\ker}_{V,U}$ by mapping~$g\in\ker_{\textrm{pre}}\phi(V)$ to the preimage of~$\res_{V,U}$ under the injection maps. As both maps are injective, this preimage is a well-defined element. We have found our induced restriction map. It is unique by commutativity of the square and the injectivity: any two maps such that~$f\circ g_1=f\circ g_2$ imply~$g_1=g_2$.

  We now check the conditions required for a presheaf. Obviously~$\res^{\ker}_{U,U}$ is the identity map and the commutativity of the restriction triangle follows from the uniqueness of the restriction maps.
\end{exercise}

\begin{exercise}
  Given a presheaf morphism~$\phi\colon\mathcal{F}\to\mathcal{G}$, we would like to characterize~$\coker_{\textrm{pre}}f$ by the universal property
  \begin{equation}
    \begin{tikzpicture}[description/.style = {fill = white, inner sep = 2pt}, baseline=(current bounding  box.center)]
      \matrix (m) [matrix of math nodes, row sep = 3em, column sep = 3em, text height = 1.5ex, text depth = 0.25ex]
      {
        & & \mathcal{H} \\
        \mathcal{F} & \mathcal{G} & \coker_{\textrm{pre}}f \\
      };
      \path[->] (m-2-1) edge node[below] {$\phi$} (m-2-2)
                (m-2-2) edge node[below] {$p$}    (m-2-3)
                (m-2-1) edge node[auto]  {$0$}    (m-1-3)
                (m-2-2) edge                      (m-1-3);
      \path[->, dashed] (m-2-3) edge node[right] {$\exists!$} (m-1-3);
    \end{tikzpicture}.
  \end{equation}

  Defining~$(\coker_{\textrm{pre}}\phi)(U)\colonequals\coker\phi(U)$, we can conclude that the universal property characterizes this definition because categorical properties of presheaves and presheaf morphisms are verified on open sets. The map~$p$ is induced by the definition and the map~$\coker_{\textrm{pre}}\phi$ exists by the ``check on open sets'' mantra and is unique for the same reason.
\end{exercise}

\begin{exercise}
  \label{exercise:33g}
  A morphism between sheaves is defined as a morphism of the category over which we are considering the sheaf for \emph{every} open set. We now restrict ourselves to a specific open set, hence the morphisms (the only nontrivial part of a functor's definition) are preserved. 

  This functor is exact because the exactness of a sequence of sheaves if checked over open sets by the fact that all abelian-categorical notions are verified ``open set by open set''. And we only consider a specific open set, over which the exactness is given.
\end{exercise}

\begin{exercise}
  The abelian-categorial notions are verified ``open set by open set'', hence we consider a family of functors as in~\autoref{exercise:33g} indexed by all open sets in the topology on~$X$. The equivalence follows.
\end{exercise}

\begin{exercise} % TODO finish
  The uniqueness of the induced restriction map and the injectivity for every open set give us the identity axiom: if all restrictions are equal we can just move everything one morphism to the right and identify things there. The same holds for the gluability axiom: given local~$f_i$, we move everything using the injectivity to the sheaf's object~$\mathcal{F}(U_i)$ and lift things to~$\mathcal{F}(U)$. Now we don't now yet that this section lives in~$\ker_{\textrm{pre}}\phi$, but if it wouldn't, there needs to be an open set for which the image under~$\phi$ is nonzero. % TODO
\end{exercise}

\begin{exercise} % TODO finish
  The inclusion~$\underline{\mathbb{Z}}\hookrightarrow\mathcal{O}_X$ is obvious: constant functions are holomorphic. Under the mapping~$f\mapsto\exp(2\pi\mathrm{i}f$ the kernel are exactly those functions such that~$\exp(2\pi\mathrm{i}f)$ is~$1$ (the neutral element in this multiplicative group). This is true for all constant integer functions:~$2\pi\mathrm{i}n$ evaluates under exponentiation to~$1$. As~$\mathcal{F}$ is the presheaf of functions admitting a holomorphic logarithm, they must come from the exponentiation of a holomorphic function contained in~$\mathcal{O}_X$ and we have the surjectivity of~$\mathcal{O}_X\twoheadrightarrow\mathcal{F}$.

  The failure of the sheaf axioms is for tomorrow.
\end{exercise}


\section{Properties determined at the level of stalks, and sheafification}

\begin{exercise}
  Assume the map is not injective, \ie, there are sections~$f$ and~$g$ in~$\mathcal{F}(U)$ such that the product of their values in the stalks in~$U$ is equal. Every value arises by construction from a section on a neighbourhood, hence for the intersection of these neighbourhoods the restrictions of~$f$ and~$g$ have to agree. Now use the identity axiom because~$\mathcal{F}$ is a separated presheaf, which leads to~$f=g$, a contradiction.
\end{exercise}

\begin{exercise}
  The notion of compatible germ corresponds to the notion of compatible sections in the gluability axiom: a germ is an equivalence class represented by an open neighbourhood with a section on it, which induces equality for the restrictions~$U_i\cap U_j$ under the equivalence relation on the stalks. Now glue together a section over~$U$, this serves as the preimage of a product of compatible germs.
\end{exercise}

\begin{exercise}
  Given a germ~$f\in\mathcal{F}_p$, represented by~$(f_U,U)$ where~$p\in U$ open, we define
  \begin{equation}
    \phi_p\colon \overline{(f_U,U)}\mapsto\overline{(\phi(f_U),U)}.
  \end{equation}

  By compatibility of restrictions, this is well-defined.
\end{exercise}

\begin{exercise}
  \label{exercise:34d}
  It is actually enough for~$\mathcal{G}$ to be a monopresheaf.

  Take any section~$s\in\mathcal{F}(U)$. We have~$f(s)$ and~$g(s)$ in~$\mathcal{G}(U)$. Because the stalk morphisms are equal, \ie, ~$f_x(s_x)=g_x(s_x)$, we can take a representative of these, obtaining an open set~$U_x$ for each~$x\in U$ where the restrictions of the sheaf morphisms agree. Using the identity axiom we have~$f(s)=g(s)$.
\end{exercise}

\begin{exercise}
  Using the diagram in~(3.4.3.1) we have injectivity for both vertical arrows by~\autoref{exercise:34d}. Now let~$f\colon\mathcal{F}\to\mathcal{G}$ be an isomorphism of sheaves. The induced stalk morphisms are by construction isomorphisms.

  For the other direction, assume all stalk morphisms are isomorphisms. The map~$\mathcal{F}(U)\to\mathcal{G}(U)$ must be injective: if there are two sections of~$\mathcal{F}$ over~$U$ mapped by~$f$ to the same section of~$\mathcal{G}$ (over~$U$) we get a contradiction on the commutativity of the square. Chasing the diagram the other way around is through an injection and a product of isomorphisms, which is injective, a contradiction. Now for the surjectivity of~$\mathcal{F}(U)\to\mathcal{G}(U)$: take a section~$g\in\mathcal{G}(U)$, consider the corresponding compatible germs, take the inverse isomorphism to the product of stalks of~$\mathcal{F}$ and use gluability to construct a section of~$\mathcal{F}$ over~$U$ which is mapped to~$g$.
\end{exercise}

\begin{exercise}
  \begin{enumerate}
    \item Consider~$X=\left\{ x,y \right\}$ equipped with the discrete topology and let~$\mathcal{F}(\left\{ x \right\}=0$, $\mathcal{F}(\left\{ y \right\})=0$ and~$\mathcal{F}(X)=\mathbb{Z}$. The stalks are the trivial group, the product is still the trivial group, so for~$U=X$ we get a contradiction on the injectivity.

    \item After a little detour to (pre)sheaves of abelian groups, back to (pre)sheaves of sets. Take~$\mathcal{F}\colonequals\underline{\left\{ p \right\}}$ and~$\mathcal{G}$ such that
      \begin{equation}
        \begin{aligned}
          \mathcal{G}(\left\{ x \right\})=\mathcal{G}(\left\{ y \right\})&=\left\{ p \right\}    \\
          \mathcal{G}(\left\{ x,y \right\})&=\left\{ p,p' \right\}
        \end{aligned}.
      \end{equation}
      We have~$\phi_1(X)(p)=p$ and~$\phi_2(X)(p)=p'$ as possible candidates, yet the induced stalk morphisms are equal.

    \item Using the same setup: we have trivial stalk isomorphisms, yet by construction the presheaves are not isomorphic.
  \end{enumerate}
\end{exercise}

\begin{exercise}
  \label{exercise:34g}
  The standard argument: take~$\mathcal{F}_1^{\sh}$ and~$\mathcal{F}_2^{\sh}$ both sheafifications of~$\mathcal{F}$. There are unique morphisms~$\mathcal{F}_1^{\sh}\to\mathcal{F}_2^{\sh}$ and~$\mathcal{F}_2^{\sh}\to\mathcal{F}_1^{\sh}$. Now we can compose these. But if I give you the identity map between both compositions, you have to agree we've obtained isomorphisms, right?

  If~$\mathcal{F}$ already is a sheaf, setting~$\mathcal{F}^{\sh}\colonequals\mathcal{F}$ satisfies the conditions of sheafification if~$\sh=\identity$: the map~$f$ equals~$g$ and is therefore uniquely defined.
\end{exercise}

\begin{exercise}
  \label{exercise:34h}
  The definition of~$\mathcal{F}^{\sh}(U)$ takes the compatible germs as sections. The identity axiom follows by definition of the sections: sections are defined by pointwise products. The gluability axiom is by definition of the compatibility: if the restrictions agree just taking the product gives us a global section.
\end{exercise}

\begin{exercise}
  Define
  \begin{equation}
    \sh\colon
    \begin{array}{ccc}
      \mathcal{F}&\to&\mathcal{F}^{\sh} \\
      s&\mapsto&\prod_{x\in U}s_x
    \end{array}.
  \end{equation}
\end{exercise}

\begin{exercise}
  First of all, by~\autoref{exercise:34h}~$\mathcal{F}^{\sh}$ is a sheaf.

  Using~\autoref{exercise:34d} we get the unique induced morphism: take the induced stalk morphisms as the morphisms for~$g$. In case it's not clear how this induces a sheaf morphism (instead of a bunch of stalk morphisms), use~\autoref{exercise:34g}.
\end{exercise}

\begin{exercise}
  Take~$\mathcal{G}$ in the definition of the sheafification to be~$\mathcal{G}^{\sh}$, the map~$g$ being~$\sh\circ\phi$. Now we get the induced~$f=\phi^{\sh}$ on the sheafifications.

  The sheafification preserves the identity, the induced~$\phi^{\sh}$ is unique by definition, but~$\identity_{\mathcal{F}^{\sh}}$ does the trick. And it agrees with compositions by the uniqueness: the composition of the sheafified morphisms serves as the candidate for the sheafification of the composition.
\end{exercise}

\begin{exercise} % TODO do this
  I'm not a category-lover, but I'll do this exercise later.
\end{exercise}

\begin{exercise} % TODO Alternative answer using Remark 3.6.3
  Stalks are defined as equivalence classes of sections on open sets. The definition of the sheafification requires the existence of a section inducing stalks. The stalks of the sheafification are the canonical projections. So we get a morphism from the stalks of the presheaf to the stalks of the sheaf by mapping~$\overline{(s_U,U)}_x$ to~$s_{U,x}$ which is by construction a stalk of the sheafification. This mapping is bijective: surjectivity follows from construction of~$\sh$ where a product of stalks arises from a section over a certain open set, take this section and set as representative of the equivalence class of a stalk in the presheaf as preimage. For the injectivity: consider two germs in~$x$ such that their image is equal in the stalk of~$\mathcal{F}^{\sh}$, by the previous observation we could've picked the inducing compatible germs with their corresponding open set as the representative of the stalk of the presheaf, which makes the two germs equal.
\end{exercise}

\begin{exercise}
  Following the order of implications as indicated by the hints:
  \begin{description}
    \item[$\textnormal{(a)}\Rightarrow\textnormal{(c)}$] A morphism of sheaves is given by a morphism of sets for each set of sections over an open set~$U$. If~$\phi$ is a monomorphism we have~$g_1=g_2$, but this condition can be applied for each open set (using the indicator sheaf if you want), obtaining the injectivity of~$\phi(U)$.

    \item[$\textnormal{(c)}\Rightarrow\textnormal{(b)}$] Take germs~$t_1$ and~$t_2$ in~$\mathcal{F}_x$ such that~$\phi_x(t_1)=\phi_x(t_2)$. Consider their representatives, there must be an open set contained in the intersection of the two open sets representing the germs such that their image is equal. But the injectivity on the level of open sets gives us that these representatives must be equal, hence the germs are too.

    \item[$\textnormal{(b)}\Rightarrow\textnormal{(a)}$] Morphisms are determined by their stalks using~\autoref{exercise:34d}, if all the stalk morphisms are injective we can use the pointwise monomorphisms to determine~$g_1=g_2$ in the definition of a monomorphism.
  \end{description}

  These proofs hold for monopresheaves as well.

  Observe that~$\textnormal{(a)}\Rightarrow\textnormal{(b)}\Rightarrow\textnormal{(c)}\Rightarrow\textnormal{(a)}$ is possible as well using the definition of compatible germs and their correspondence with sheaves. For this chain of implications to be easy to proof we do need the sheaf condition though.
\end{exercise}

\begin{exercise}
  By the observations from~\autoref{exercise:34g} and the construction of the sheafification, all the properties are defined on the level of stalks. If~$\phi$ is an epimorphism, this holds for the products of stalks, implying epimorphisms on each stalk and the other direction is analogous.
\end{exercise}

\begin{exercise}
  The map~$\exp\colon\mathcal{O}_X\to\mathcal{O}_X^*$ is an epimorphism: at the level of the stalks we have for a nowhere zero~$g$ that~$g$ is nowhere zero in a neighbourhood of~$x$, which can be taken as a representative and which admits a local logarithm.

  But if we take a open neighbourhood of zero and puncture it there (or more general: any open set that is not contractible) we can construct a function that is nowhere zero, but is not in the image of~$\exp$: the winding number causes the function~$z\mapsto z$ to be an section of~$\mathcal{O}_X^*$ but there is no section in~$\mathcal{O}_X$ mapping to it.
\end{exercise}
